<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oma Opiskelu</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:Arial, Helvetica, sans-serif;
background:#111827;
color:white;
}

/* LOGIN */
#loginScreen{
display:none;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.loginbox{
background:#1f2937;
padding:30px;
border-radius:12px;
width:300px;
text-align:center;
}

.loginbox input{
width:100%;
padding:12px;
margin:10px 0;
border:none;
border-radius:8px;
}

.loginbox button{
width:100%;
padding:12px;
background:#22c55e;
border:none;
border-radius:10px;
color:white;
font-size:16px;
}

/* APP */
#app{
display:none;
height:100vh;
background:#f3f4f6;
color:black;
}

.container{
display:flex;
height:100%;
}

.sidebar{
width:260px;
background:#111827;
color:white;
padding:20px;
}

.chapter{
padding:12px;
margin-bottom:8px;
background:#1f2937;
border-radius:8px;
cursor:pointer;
}

.chapter:hover{
background:#374151;
}

.main{
flex:1;
display:flex;
justify-content:center;
align-items:center;
}

.card{
background:white;
padding:20px;
border-radius:14px;
max-width:650px;
width:100%;
text-align:center;
}

img{
max-width:100%;
border-radius:10px;
}

button{
margin-top:15px;
padding:12px 18px;
font-size:16px;
border:none;
border-radius:10px;
background:#16a34a;
color:white;
}

#solution{
display:none;
margin-top:20px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen">
  <div class="loginbox">
    <h2>Kirjaudu sisään</h2>
    <input id="email" placeholder="Sähköposti">
    <input id="password" type="password" placeholder="Salasana">
    <button onclick="login()">Kirjaudu</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <div class="container">
    <div class="sidebar">
      <h2>Oppiaineet</h2>
      <div class="chapter" onclick="loadTask('bio1')">Biologia 1.1</div>
      <div class="chapter" onclick="loadTask('bio2')">Biologia 1.2</div>
    </div>

    <div class="main">
      <div class="card">
        <h2 id="title">Valitse kappale vasemmalta</h2>
        <img id="taskImage">
        <div id="solution">
          <h3>Malliratkaisu</h3>
          <img id="solutionImage">
        </div>
        <button onclick="showSolution()">Näytä malliratkaisu</button>
      </div>
    </div>
  </div>
</div>

<script>
const supabase = window.supabase.createClient(
"https://ffrfdlfhejcezsnhfqcl.supabase.co",
"sb_publishable_pwMiK_GvtlVNILSaDSfHxg_QDTYY2SN"
);

async function checkUser(){
const { data } = await supabase.auth.getSession();

if(data.session){
document.getElementById("app").style.display="block";
}else{
document.getElementById("loginScreen").style.display="flex";
}
}

async function login(){
const email=document.getElementById("email").value;
const password=document.getElementById("password").value;

const { error } = await supabase.auth.signInWithPassword({
email,
password
});

if(error){
alert("Väärä sähköposti tai salasana");
}else{
location.reload();
}
}

function loadTask(chapter){
document.getElementById("title").innerText="Tehtävä - "+chapter;
document.getElementById("taskImage").src="https://via.placeholder.com/600x800?text=Tehtävä";
document.getElementById("solutionImage").src="https://via.placeholder.com/600x800?text=Ratkaisu";
document.getElementById("solution").style.display="none";
}

function showSolution(){
document.getElementById("solution").style.display="block";
}

checkUser();
</script>

</body>
</html>
